<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>米家的飞利浦智睿球泡灯拆解与固件提取 | ZnHoCn&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="飞利浦智睿球泡灯是一款可连接 WiFi 的小米智能设备，可通过米家手机应用进行控制。通过外包装上的 CMIIT-ID: 2016DP3252 号可查询到其使用的控制芯片是 ESP8266 系列里的 ESP-WROOM-02 模块。">
<meta name="keywords" content="Mijia,ESP8266,Firmware">
<meta property="og:type" content="article">
<meta property="og:title" content="米家的飞利浦智睿球泡灯拆解与固件提取">
<meta property="og:url" content="https://znhocn.github.io/posts/2017/12/08/Philips-Smart-Led-Ball-Lamp-Dismantling-and-Firmware-extraction/index.html">
<meta property="og:site_name" content="ZnHoCn&#39;s Blog">
<meta property="og:description" content="飞利浦智睿球泡灯是一款可连接 WiFi 的小米智能设备，可通过米家手机应用进行控制。通过外包装上的 CMIIT-ID: 2016DP3252 号可查询到其使用的控制芯片是 ESP8266 系列里的 ESP-WROOM-02 模块。">
<meta property="og:locale" content="zh-TW">
<meta property="og:image" content="https://files.hakr.xyz/images/2017-12-08_01-0001.jpg">
<meta property="og:image" content="https://files.hakr.xyz/images/2017-12-08_01-0002.jpg">
<meta property="og:image" content="https://files.hakr.xyz/images/2017-12-08_01-0003.jpg">
<meta property="og:image" content="https://files.hakr.xyz/images/2017-12-08_01-0004.jpg">
<meta property="og:image" content="https://files.hakr.xyz/images/2017-12-08_01-0005.jpg">
<meta property="og:image" content="https://files.hakr.xyz/images/2017-12-08_01-0006.jpg">
<meta property="og:image" content="https://files.hakr.xyz/images/2017-12-08_01-0007.png">
<meta property="og:image" content="https://files.hakr.xyz/images/2017-12-08_01-0008.jpg">
<meta property="og:updated_time" content="2018-02-21T08:44:22.803Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="米家的飞利浦智睿球泡灯拆解与固件提取">
<meta name="twitter:description" content="飞利浦智睿球泡灯是一款可连接 WiFi 的小米智能设备，可通过米家手机应用进行控制。通过外包装上的 CMIIT-ID: 2016DP3252 号可查询到其使用的控制芯片是 ESP8266 系列里的 ESP-WROOM-02 模块。">
<meta name="twitter:image" content="https://files.hakr.xyz/images/2017-12-08_01-0001.jpg">
  
    <link rel="alternate" href="/atom.xml" title="ZnHoCn&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
    <!--<link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">-->
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">ZnHoCn&#39;s Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="//www.hakr.xyz">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-twitter-link" class="nav-icon" href="https://twitter.com/znhocn" target="_blank" title="Twitter"></a>
        
        
          <a id="nav-github-link" class="nav-icon" href="https://github.com/znhocn" target="_blank" title="GitHub"></a>
        
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜尋"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://znhocn.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Philips-Smart-Led-Ball-Lamp-Dismantling-and-Firmware-extraction" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/posts/2017/12/08/Philips-Smart-Led-Ball-Lamp-Dismantling-and-Firmware-extraction/" class="article-date">
  <time datetime="2017-12-08T10:51:54.000Z" itemprop="datePublished">2017-12-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      米家的飞利浦智睿球泡灯拆解与固件提取
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://item.mi.com/1172100033.html" target="_blank" rel="noopener">飞利浦智睿球泡灯</a>是一款可连接 WiFi 的小米智能设备，可通过米家手机应用进行控制。通过外包装上的 <a href="https://fccid.io/CMIIT-ID-2016DP3252" target="_blank" rel="noopener">CMIIT-ID: 2016DP3252</a> 号可查询到其使用的控制芯片是 ESP8266 系列里的 <a href="http://espressif.com/zh-hans/products/hardware/esp-wroom-02/overview" target="_blank" rel="noopener">ESP-WROOM-02</a> 模块。<br><a id="more"></a></p>
<h1 id="1-设备拆解"><a href="#1-设备拆解" class="headerlink" title="1 设备拆解"></a>1 设备拆解</h1><h2 id="1-1-打开灯罩"><a href="#1-1-打开灯罩" class="headerlink" title="1.1 打开灯罩"></a>1.1 打开灯罩</h2><p>使用热风枪先把粘胶加热一下，对着粘合处灯泡转着吹，别一直吹一个点否则会直接融化灯罩。</p>
<p>加热的差不多的时候可以用手掰开一条缝隙，拿可以撬的工具沿着边一点点撬开，这里使用开夏威夷果的钥匙挺方便的。</p>
<p><img src="//files.hakr.xyz/images/2017-12-08_01-0001.jpg" alt=""></p>
<h2 id="1-2-拆除-LED-板"><a href="#1-2-拆除-LED-板" class="headerlink" title="1.2 拆除 LED 板"></a>1.2 拆除 LED 板</h2><p>先用电烙铁拆焊掉 3 根导线，再把 LED 板撬下来，板与底座是胶粘合的，可以尝试先加热一下再撬。</p>
<p><img src="//files.hakr.xyz/images/2017-12-08_01-0002.jpg" alt=""></p>
<h2 id="1-3-取出电源与控制模块"><a href="#1-3-取出电源与控制模块" class="headerlink" title="1.3 取出电源与控制模块"></a>1.3 取出电源与控制模块</h2><p>电源模块与控制模块是焊在一起的，被一颗胶粘着与底座固定。需要用美工刀把这颗胶割开，再把整个模块向外拉。底部的零线和火线与灯座的金属接触部分并非是焊接上的而是卡住的，拉的时候用点力，多拉几次就能取出来。</p>
<p><img src="//files.hakr.xyz/images/2017-12-08_01-0003.jpg" alt=""></p>
<h2 id="1-4-拆下-WiFi-控制模块"><a href="#1-4-拆下-WiFi-控制模块" class="headerlink" title="1.4 拆下 WiFi 控制模块"></a>1.4 拆下 WiFi 控制模块</h2><p>WiFi 控制模块是通过 4 个针脚焊接在电源模块上的，需要用电烙铁来拆下它。</p>
<p><img src="//files.hakr.xyz/images/2017-12-08_01-0004.jpg" alt=""><br><img src="//files.hakr.xyz/images/2017-12-08_01-0005.jpg" alt=""></p>
<h2 id="1-5-焊接跳线"><a href="#1-5-焊接跳线" class="headerlink" title="1.5 焊接跳线"></a>1.5 焊接跳线</h2><p>拆下 WiFi 控制模块后去掉外面包的热缩管，再用热风枪吹掉背面的一颗 R41 的贴片元件(否则无法调试这个模块)。</p>
<p><img src="//files.hakr.xyz/images/2017-12-08_01-0006.jpg" alt=""></p>
<p>再按下图所示在模块的对应针脚上焊上跳线接到面包板上 </p>
<ul>
<li>注: 图上两个模式的接法是反的，<code>IO0</code> 接 <code>GND</code> 进入的是刷固件的模式，RTOS 不会启动。<code>IO0</code> 接 <code>3.3V</code> 时进入的是串口模式，可以看到调试信息。</li>
</ul>
<p><img src="//files.hakr.xyz/images/2017-12-08_01-0007.png" alt=""><br><img src="//files.hakr.xyz/images/2017-12-08_01-0008.jpg" alt=""></p>
<h1 id="2-固件提取"><a href="#2-固件提取" class="headerlink" title="2 固件提取"></a>2 固件提取</h1><h2 id="2-1-安装工具软件"><a href="#2-1-安装工具软件" class="headerlink" title="2.1 安装工具软件"></a>2.1 安装工具软件</h2><p>WiFi 控制模块是 ESP8266 的芯片，这里我们使用 <a href="https://github.com/espressif/esptool" target="_blank" rel="noopener">esptool</a> 这个工具。<br>这是一个 <a href="https://www.python.org/" target="_blank" rel="noopener">Python</a> 写的工具所以你需要先安装 <code>python</code> 和 <code>python-pip</code> 再用 <code>pip</code> 安装 <code>esptool</code> 。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install esptool</span><br></pre></td></tr></table></figure>
<h2 id="2-2-固件提取操作"><a href="#2-2-固件提取操作" class="headerlink" title="2.2 固件提取操作"></a>2.2 固件提取操作</h2><p>使用 USB to TTL 工具 (建议使用 CP2102 芯片的) 把设备连接到你的电脑找到设备的串口号。</p>
<p>查看模块上的 Flash 芯片信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># esptool.py -p COM3 flash_id</span></span><br><span class="line"></span><br><span class="line">esptool.py v2.2</span><br><span class="line">Connecting....</span><br><span class="line">Detecting chip <span class="built_in">type</span>... ESP8266</span><br><span class="line">Chip is ESP8266EX</span><br><span class="line">Uploading stub...</span><br><span class="line">Running stub...</span><br><span class="line">Stub running...</span><br><span class="line">Manufacturer: c8</span><br><span class="line">Device: 4015</span><br><span class="line">Detected flash size: 2MB    // 这个可以看到 Flash 芯片的大小是 2MB</span><br><span class="line">Hard resetting...</span><br></pre></td></tr></table></figure>
<p>读取芯片数据到文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">esptool.py -p COM3 read_flash 0x00000 0x200000 flash_0.bin    // 0x00000 是起始地址， 0x200000 是结束地址，这里所指定 dump 的大小是 2MB</span><br></pre></td></tr></table></figure>
<p>一些使用示例</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">esptool.py -p COM3 chip_id    // 查看主控芯片信息</span><br><span class="line">esptool.py -p COM3 flash_id    // 查看 Flash 信息</span><br><span class="line">esptool.py -p COM3 read_mac    // 查看 MAC 地址</span><br><span class="line">esptool.py -p COM3 image_info my_app.bin    // 读取二进制固件文件的信息</span><br><span class="line">esptool.py -p COM3 dump_mem 0x3FF00000 65552 dport0_0.bin    // dump 芯片内 Dport0 地址块的数据到文件</span><br><span class="line">esptool.py -p COM3 dump_mem 0x3ffe8000 2748 data_0.bin</span><br><span class="line">esptool.py -p COM3 dump_mem 0x3ffe8b90 8840 rodata_0.bin</span><br><span class="line">esptool.py -p COM3 dump_mem 0x3ffeae18 28808 bss_0.bin</span><br><span class="line">esptool.py -p COM3 dump_mem 0x3fff1ea0 57696 heap_0.bin</span><br><span class="line">esptool.py -p COM3 dump_mem 0x40000000 65536 iram_0.bin</span><br><span class="line">esptool.py -p COM3 read_flash_status    // 查看 Flash 状态</span><br><span class="line">esptool.py -p COM3 read_flash 0x00000 0x100000 flash_0.bin   // dump 1MB 大小的 Flash 数据到文件</span><br><span class="line">esptool.py -p COM3 read_flash 0x00000 0x200000 flash_0.bin   // 2MB</span><br><span class="line">esptool.py -p COM3 read_flash 0x00000 0x400000 flash_0.bin   // 4MB</span><br><span class="line">esptool.py -p COM3 read_flash 0x00000 0x800000 flash_0.bin   // 4MB</span><br><span class="line">esptool.py -p COM3 read_flash 0x00000 0x1600000 flash_0.bin  // 16MB</span><br><span class="line">esptool.py -p COM3 erase_flash    // 擦除 Flash 芯片上的所有数据</span><br><span class="line">esptool.py -p COM3 write_flash 0x00000 my_app.bin    // 写入新固件到 Flash</span><br></pre></td></tr></table></figure>
<p>更多用法去查看帮助</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">esptool.py help</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://znhocn.github.io/posts/2017/12/08/Philips-Smart-Led-Ball-Lamp-Dismantling-and-Firmware-extraction/" data-id="cjq5j2i3v001750tx4wjag1sk" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ESP8266/">ESP8266</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Firmware/">Firmware</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Mijia/">Mijia</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/posts/2017/12/17/Hacking-Philips-Smart-Led-Ball-Lamp/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Hacking 飞利浦智能球泡灯
        
      </div>
    </a>
  
  
    <a href="/posts/2017/08/15/How-to-Get-YouTube-4K-Videos/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">如何获取 YouTube 4K 视频</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/posts/2018/12/26/TP-Link-TL-MR10U-Install-Breed-Bootloader-and-OpenWrt/">TP-Link TL-MR10U Install Breed Bootloader + OpenWrt</a>
          </li>
        
          <li>
            <a href="/posts/2018/12/19/Android-eMMC-Data-Recovery/">Android eMMC Data Recovery</a>
          </li>
        
          <li>
            <a href="/posts/2018/07/21/Replace-Ali-socket-control-module-into-Xiaomi-control-module/">替换阿里智能插座控制模组為小米控制模组</a>
          </li>
        
          <li>
            <a href="/posts/2018/05/05/How-to-Make-Redscale-Film/">如何製作紅色膠片 (Redscale Film)</a>
          </li>
        
          <li>
            <a href="/posts/2018/01/23/My-country-is-not-government/">我的國家不是政府</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">標籤雲</h3>
    <div class="widget tagcloud">
      <a href="/tags/4K/" style="font-size: 10px;">4K</a> <a href="/tags/Ali/" style="font-size: 10px;">Ali</a> <a href="/tags/Android/" style="font-size: 10px;">Android</a> <a href="/tags/Annual-summary/" style="font-size: 15px;">Annual summary</a> <a href="/tags/Breed-Bootloader/" style="font-size: 10px;">Breed Bootloader</a> <a href="/tags/Data-Recovery/" style="font-size: 10px;">Data Recovery</a> <a href="/tags/ESP8266/" style="font-size: 15px;">ESP8266</a> <a href="/tags/Film/" style="font-size: 10px;">Film</a> <a href="/tags/Firmware/" style="font-size: 10px;">Firmware</a> <a href="/tags/Hacking/" style="font-size: 15px;">Hacking</a> <a href="/tags/Hardware/" style="font-size: 20px;">Hardware</a> <a href="/tags/IPCamera/" style="font-size: 10px;">IPCamera</a> <a href="/tags/Mijia/" style="font-size: 15px;">Mijia</a> <a href="/tags/OpenWrt/" style="font-size: 10px;">OpenWrt</a> <a href="/tags/PGP/" style="font-size: 10px;">PGP</a> <a href="/tags/Political/" style="font-size: 10px;">Political</a> <a href="/tags/Radio/" style="font-size: 10px;">Radio</a> <a href="/tags/Redscale/" style="font-size: 10px;">Redscale</a> <a href="/tags/Reverse-Engineering/" style="font-size: 10px;">Reverse Engineering</a> <a href="/tags/Smart-Plug/" style="font-size: 10px;">Smart Plug</a> <a href="/tags/Smart-Socket/" style="font-size: 10px;">Smart Socket</a> <a href="/tags/TL-MR10U/" style="font-size: 10px;">TL-MR10U</a> <a href="/tags/Xiaomi/" style="font-size: 10px;">Xiaomi</a> <a href="/tags/YARD-Stick-One/" style="font-size: 10px;">YARD Stick One</a> <a href="/tags/YouTube/" style="font-size: 10px;">YouTube</a> <a href="/tags/YubiKey/" style="font-size: 10px;">YubiKey</a> <a href="/tags/eMMC/" style="font-size: 10px;">eMMC</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">友情連結</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="https://blog.iternull.com" target="_blank">IterNull Blog</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 ZnHoCn<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="//www.hakr.xyz" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    

<script src="/js/jquery-2.0.3.min.js" type='text/javascript'></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>